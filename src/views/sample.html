<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>.: Page Designer :.</title>
    <meta name="robots" content="noindex, nofollow" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <!-- Prototype styles -->
    <link rel="stylesheet" href="/styles/index.css" />

    <!-- comment out dropbox for now -->
    <!--script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="ug0ns8z2dvqvxvi"></script-->

<style>
#canvas {
    margin: 50px auto;
    max-width: 960px;
    background-color: #fff;
    border:1px solid #e5e5e5;
}
#canvas h3 {
    padding: 10px;
    border-bottom:1px solid #e5e5e5;
}
#editor_area {
    min-height: 450px;
}
#am2_visual_add {
    margin: 15px;
    min-height: 80px;
    border:1px dashed rgba(125,125,125,.4);
    text-align: center;
    line-height: 80px;
}
.content__row {
    margin: 15px;
    min-height: 80px;
    overflow: hidden;
}
.content__columns {
    overflow: hidden;
    border:1px dashed rgba(125,125,125,.4);
    border-top:0;
}
.column__wrapper {
    background-color: #f1f1f1;
    min-height: 100px;
    margin: 15px 0;
    border-radius: 3px;
}
.column__content {
    min-height: 80px;
}
.column__wrapper {
    text-align: center;
}
.column__wrapper .content__widget {
    margin: 15px;
    padding: 15px;
    cursor: move;
    background-color: #ddd;
}
.content__name {
    background-color: #444;
    color: #fff;
    cursor: move;
}
.column__name {
    padding-top: 10px;
    text-align: center;
    display: block;
    cursor: move;
}
.column__footer {
    text-align: center;
    padding-bottom: 10px;
}
.row_actions {
    display: inline-block;
    float: right;
}
.row_actions a {
    color: #fff;
}
.column__footer a {
    color: #444;
}
#add-el {
    color: #444;
    font-size: 21px;
    background: #f1f1f1;
    border-radius: 3px;
    padding: 4px;
}
.sortable-ghost {
  opacity: .3;
    -webkit-transition: opacity .6s;
    -moz-transition: opacity .6s;
    -o-transition: opacity .6s;
    -ms-transition: opacity .6s;
    transition: opacity .6s;
}


</style>
</head>

<body>
<div class="slds-grid">

    <div class="slds-size-1-of-4" id="tools">
      <ul class="slds-has-dividers_around-space">
        <li class="slds-item" id="listA">
          <div class="slds" id="component_a">
              A
          </div>
        </li>
        <li class="slds-item" id="listB">
          <div class="column six" id="component_b">
              Column
          </div>
        </li>
      </ul>
    </div>
    <div class="slds-size-3-of-4" id="canvas">
        <div class="slds-col" id="editor_area">
            <div class="content__row">
                <h3 class="content__name">Region
                    <span class="row_actions">
                        <a href="#"><i class="icon-pencil"></i></a>
                        <a href="#"><i class="icon-trash"></i></a>
                        <a href="#"><i class="icon-align-justify"></i></a>
                    </span>
                </h3>
                <div id="group-1" class="slds-grid slds-col content__columns">
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">1</div>
                              <div class="content__widget">2</div>
                              <div class="content__widget">3</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">4</div>
                              <div class="content__widget">5</div>
                              <div class="content__widget">6</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">1</div>
                              <div class="content__widget">2</div>
                              <div class="content__widget">3</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">4</div>
                              <div class="content__widget">5</div>
                              <div class="content__widget">6</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <!--
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">1</div>
                              <div class="content__widget">2</div>
                              <div class="content__widget">3</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">4</div>
                              <div class="content__widget">5</div>
                              <div class="content__widget">6</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">1</div>
                              <div class="content__widget">2</div>
                              <div class="content__widget">3</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">4</div>
                              <div class="content__widget">5</div>
                              <div class="content__widget">6</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">1</div>
                              <div class="content__widget">2</div>
                              <div class="content__widget">3</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">4</div>
                              <div class="content__widget">5</div>
                              <div class="content__widget">6</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">1</div>
                              <div class="content__widget">2</div>
                              <div class="content__widget">3</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                  <div class="slds-col column six">
                      <div class="column__wrapper">
                          <span class="column__name">
                              <i class="icon-pencil"></i>
                              <i class="icon-move"></i>
                          </span>
                          <div class="column__content">
                              <div class="content__widget">4</div>
                              <div class="content__widget">5</div>
                              <div class="content__widget">6</div>
                          </div>
                          <div class="column__footer">
                              <a href="#"><i class="icon-plus"></i></a>
                          </div>
                      </div>
                  </div>
                -->
                </div>
            </div>
            <div class="content__row">
                <h3 class="content__name">Region
                    <span class="row_actions">
                        <a href="#"><i class="icon-pencil"></i></a>
                        <a href="#"><i class="icon-trash"></i></a>
                        <a href="#"><i class="icon-align-justify"></i></a>
                    </span>
                </h3>
                <div id="group-2" class="content__columns">
                    <div class="column four">
                        <div class="column__wrapper">
                            <span class="column__name">
                                <i class="icon-pencil"></i>
                                <i class="icon-move"></i>
                            </span>
                            <div class="column__content">
                                <div class="content__widget">prvi</div>
                                <div class="content__widget">drugi</div>
                                <div class="content__widget">treci</div>
                            </div>
                            <div class="column__footer">
                                <a href="#"><i class="icon-plus"></i></a>
                            </div>
                        </div>
                    </div>
                    <div class="column four">
                        <div class="column__wrapper">
                            <span class="column__name">
                                <i class="icon-pencil"></i>
                                <i class="icon-move"></i>
                            </span>
                            <div class="column__content">
                                <div class="content__widget">prvi</div>
                                <div class="content__widget">drugi</div>
                                <div class="content__widget">treci</div>
                            </div>
                            <div class="column__footer">
                                <a href="#"><i class="icon-plus"></i></a>
                            </div>
                        </div>
                    </div>
                    <div class="column four">
                        <div class="column__wrapper">
                            <span class="column__name">
                                <i class="icon-pencil"></i>
                                <i class="icon-move"></i>
                            </span>
                            <div class="column__content">
                                <div class="content__widget">prvi</div>
                                <div class="content__widget">drugi</div>
                                <div class="content__widget">treci</div>
                            </div>
                            <div class="column__footer">
                                <a href="#"><i class="icon-plus"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="am2_visual_add"><a id="add-el" href="#"><i class="icon-plus"></i></a></div>
    </div>
    <div style="display:none;" id="row__copy">
        <h3 class="content__name">Row
        <span class="row_actions">
                <a href="#"><i class="icon-pencil"></i></a>
                <a href="#"><i class="icon-trash"></i></a>
                <a href="#"><i class="icon-align-justify"></i></a>
            </span>
        </h3>
        <div id="group" class="content__columns">
            <div class="column twelve">
                <div class="column__wrapper">
                    <span class="column__name">
                        <i class="icon-pencil"></i>
                        <i class="icon-move"></i>
                    </span>
                    <div class="column__content">
                    </div>
                    <div class="column__footer">
                        <a href="#"><i class="icon-plus"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>



  </div>



    <!-- JS -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script> -->
    <script src='/scripts/sortable.js'></script>
    <script src='/scripts/jquery-3.2.1.min.js'></script>
    <script src='/scripts/jquery-ui.min.js'></script>
    <script src='/scripts/utils.js'></script>
    <script src='/scripts/tether.min.js'></script>


    <script>
    (function(){
    	'use strict';
    	var id = function(id) {
    		return document.getElementById(id);
    	}
    	var col_id = 1
    	var master = Sortable.create(id('editor_area'), {
    	    animation: 150,
    	    draggable: '.content__row',
    	    handle: '.content__name',
    	    ghostClass: "sortable-ghost",
    	});

      var toolsA = Sortable.create(id('listA'), {
    	    animation: 150,

          group:{
            name: 'shared',
            pull: 'clone',
            put: false,
            ghosting: true,
            ghostClass: 'sortable-ghost',
            revertClone: true,
            handle: '.my-handle'
          },
          sort: false,
          filter: '.ignore-elements',
          /*
    	    draggable: '.content__row',
    	    handle: '.content__name',
    	    ghostClass: "sortable-ghost",
          */
    	});

      var toolsB = Sortable.create(id('listB'), {
    	    animation: 150,

          group:{
            name: 'content__column',
            pull: 'clone',
            put: false,
            ghosting: true,
            ghostClass: 'sortable-ghost',
            revertClone: true,
            handle: '.my-handle'
          },
          sort: false,
          filter: '.ignore-elements',
          /*
    	    draggable: '.content__row',
    	    handle: '.content__name',
    	    ghostClass: "sortable-ghost",
          */
    	});




    	[].forEach.call(id('editor_area').getElementsByClassName('column__content'), function (el) {
            Sortable.create(el, {
                group: 'shared',
                animation: 150
            });
        });

    	[].forEach.call(id('editor_area').getElementsByClassName('content__columns'), function (el) {
    		var id = el.id
            Sortable.create(el, {
                group: 'column'+id,
                handle: '.column__name',
                animation: 150
            });
        });

    	// fix: need to destroy old instances before recreating new ones.
    	  id('add-el').addEventListener('click', function(e) {
    	    e.preventDefault();

    	    var row = document.createElement('div');
    	    row.setAttribute("class","content__row");
    		row.innerHTML = id("row__copy").innerHTML;
    	    id("editor_area").appendChild(row);

    		[].forEach.call(id('editor_area').getElementsByClassName('column__content'), function (el) {
    	        Sortable.create(el, {
    	            group: 'shared',
    	            animation: 150
    	        });
    	    });

    	    // fix: add unique group id to each new row.
    	    col_id++
    		[].forEach.call(id('editor_area').getElementsByClassName('content__columns'), function (el) {
    			var id = el.id
    	        Sortable.create(el, {
    	            group: 'column'+id,
    	            handle: '.column__name',
    	            animation: 150
    	        });
    	    });

    	}, false);
    })();
    </script>


</body>

</html>
