<!DOCTYPE html>
<html lang='en' class='list-view'>

  <head>
    <meta charset='utf-8'/>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'/>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'/>
    <title>.: Page Designer :.</title>
    <meta name='robots' content='noindex, nofollow'/>
    <link rel='icon' type='image/png' href='/favicon.png'/>
    <link rel='stylesheet' href='/styles/index.css'/>
    <!-- Prototype styles -->
  </head>

  <body>

<div class="slds-grid slds-p-around_small">
  <div class="slds-col">
    <ul id="components" class="connectedSortable">
        <li class="ui-state-default">Item 1</li>
        <li class="ui-state-default">Item 2</li>
    </ul>
  </div>

    <div class="slds-col" id="canvas">
    <ul class="connectedSortable">
      <ul id="region1" class="moveable">
        region 1
      </ul>
      <ul id="region2" class="moveable">
        region 2
      </ul>
    </ul>
    </div>
    <div class="slds-col" id="pagestructure">
      pagestructure
    </div>
</div>


<script src='/scripts/jquery-3.2.1.min.js'></script>
<script src='/scripts/jquery-ui.min.js'></script>
<script src='/scripts/utils.js'></script>
<script src='/scripts/tether.min.js'></script>

<script>
//simply use 1 nested list instead of multiple ones, use the slds classes to align the list cells vertical and horizontal
//sorting in pagestructure not working yet
$("#components").sortable({
    helper:"clone",
    connectWith: ".connectedSortable",
    forcePlaceholderSize: false,
    helper: function (e, li) {
        copyHelper = li.clone().insertAfter(li);
        return li.clone();
    },
    stop: function () {
        console.log('sortable drop');
        copyHelper && copyHelper.remove();
    }
}).disableSelection();

$("#canvas .connectedSortable").sortable({
      helper: "clone",
      receive: function (e, ui) {
      console.log('canvas receive');
      document.querySelector('#pagestructure').innerHTML = document.querySelector('#canvas').innerHTML;
      copyHelper = null;
    },
    stop:  function (e, ui) {
      console.log('stop');
      //$("#pagestructure").innerHTML = $("#canvas").innerHTML;
      document.querySelector('#pagestructure').innerHTML = document.querySelector('#canvas').innerHTML;
    },
}).disableSelection();


$("#pagestructure .connectedSortable").sortable({
    receive: function (e, ui) {
      console.log('pagestructure A');
      copyHelper = null;
    },
    stop:  function (e, ui) {
      console.log('pagestructure B');
      //$("#pagestructure").innerHTML = $("#canvas").innerHTML;
      document.querySelector('#canvas').innerHTML = document.querySelector('#pagestructure').innerHTML;
    },
}).disableSelection();
</script>

<style>
li{
  border: 1px solid #ccc;
  background: #eee;
}
li:hover{
  background: #ccc;
  cursor:grab;
}

  .dragged, .ui-sortable-helper{
    -webkit-transition: transform .25s ease-in-out;
    -moz-transition: transform .25s ease-in-out;
    -o-transition: transform .25s ease-in-out;
    transition: transform .25s ease-in-out;

    -webkit-transition: box-shadow .25s ease-in-out;
    -moz-transition: box-shadow .25s ease-in-out;
    -o-transition: box-shadow .25s ease-in-out;
    transition: box-shadow .25s ease-in-out;
    &:hover {
      cursor: pointer;
      background-color: #eaeaea;
    }
  }

  .draggable-item.ui-sortable-helper {
    background-color: #e5e5e5;
    -webkit-box-shadow: 0 0 8px rgba(53,41,41, .8);
    -moz-box-shadow: 0 0 8px rgba(53,41,41, .8);
    box-shadow: 0 0 8px rgba(53,41,41, .8);
    transform: scale(1.015);
    z-index: 100;
  }
  .draggable-item.ui-sortable-placeholder {
    background-color: #ddd;
    -moz-box-shadow:    inset 0 0 10px #000000;
     -webkit-box-shadow: inset 0 0 10px #000000;
     box-shadow:         inset 0 0 10px #000000;
  }


</style>



  </body>
</html>
